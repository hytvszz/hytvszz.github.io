---
layout: post
title: "如何电脑永不锁屏，Teams永远在线 "
date:   2022-10-06
tags: [IT]
language : Chinese
comments: true
author: Zhen
toc: false
published: true
hidden: false
---
最近电脑忽然开始自动锁屏，无论怎么调整电池计划、休眠、屏保时间，都没有办法阻止window自动锁定，跳到刚开机之后的登录界面，这个界面再加上需要ctrl+alt+del才能解锁，非常的恶心。刚开始还以为是window升级之后改了设置一类，后来发现是公司管硬件的大哥更新的公司policy，防止大家不锁屏就到处走来走去。因为大家都是用microsoft账户登录的，所以他可以从那里强制设定一些公司policy，这些无论你怎么都没法更改，或者改了会被强制改回来。

这里罗列一些尝试过的失败的方法，大家就不用自己走弯路了：
1. 任何电脑设置界面、控制面板里更改的休眠、屏保时间，电池计划的选项等等
2. 修改注册表，包括删除/更改screensavertime的相关选项，以及power文件夹的各种设定
3. 通过浏览器（包括IE）运行的javaScript脚本，是利用ActiveXObject的，现在因为网络安全的原因，已经不能再js里使用了   
    function PressKey(){   
    var objWs = new ActiveXObject("Wscript.Shell");   
    objWs.SendKeys("{SCROLLLOCK}"); }   
    setInterval("PressKey()",60000);   

这里介绍两个可行的办法：
1. 打开YouTube播放。只要视频一直在前台播放，电脑就不会锁屏。这是最简单的办法，但是有个缺点就是可能会有什么邮件啊，弹窗啊之类的，只要播放YouTube的网页不是最前台，切换到别的tab或者程序，都没法阻止锁屏。
2. 利用chrome插件。可能有好几款，我用的叫Keep Awake (Display | System)，安装之后，可以选择开启关闭，开启之后它有两个模式（System/display），测试了只有display模式管用，激活之后只要chrome不关闭，电脑就不会锁屏。

但是、然而！上边两个办法，仍然不能阻止Teams自动离开，这可能是Teams采用了不同的监测机制，我推测是利用点击键盘的事件。Teams的离开触发条件也是：5分钟之内没有点击键盘。
光点鼠标是没用的

换了新

笔记本之后发现用蓝牙连接罗技鼠标的时候，基本上每分钟都会出现鼠标1-2秒的卡顿，切换成自带的wifi发射器之后则没有这个问题，所以应该是windows蓝牙出了问题，找到了一个解决方案，就是在注册表禁用蓝牙的频繁自动搜索之类的，应该是这个功能造成的延时。

### Prevent the System from Disabling Bluetooth

Tweak your Registry Editor to stop the system from disabling Bluetooth connections.

1.  Click on the  **Search icon**  and type  **Registry Editor**.
2.  Double-click on the Registry Editor to launch the app.
3.  Navigate to  `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Enum\USB\VID_8087&PID_0026\5&2ce2e494&0&10\Device Parameters`
4.  Then, add the following entries （**New** → **DWORD 32-bit Value**）,set value to 0
    -   `DeviceSelectiveSuspended`
    -   `SelectiveSuspendEnabled`
    -   `SelectiveSuspendSupported`
5. Reboot laptop
<!--stackedit_data:
eyJoaXN0b3J5IjpbMTUzNjczOTI0NywtMTg5MjM1NjEzMSwtMT
c1NjAwNDQ5NiwtMTg5Nzk1Mjc0NywtNTU1MjM1ODk0XX0=
-->